
!----------global simulation parameters----------
simulation
{
 !algorithm = "cuda",
}


!--------the node configuration for this simulation--------
node_conf 
{
 node_number = 1, 8, ! number of GPUs you are using
 n_threads = 4, ! number of threads per GPU
 !tile_number = 32, 64, ! n_tiles_tot should be greater than n_cells_tot / 1024 and be a power of two. Refer to osiris cuda documentation
 if_periodic(1:2) = .true., .false.,
}


!----------spatial grid----------
grid
{
 nx_p = 210, 14421, ! number of cells 
}


!----------time step and global data dump timestep number----------
time_step
{
 dt     = 0.0471, ! time step in wpe^-1
 ndump  = 4856, ! number of time steps between data dumps,
}


!----------restart information----------
restart
{
! It seems like restart is broken on the GPU version
!  ndump_fac = -1,
!  ndump_time = 3590, !once/hour
!  if_restart = .false.,
!  if_remold = .true.,
}


!----------spatial limits ----------
space
{
 xmin(1:2) = -7, 0,
 xmax(1:2) = 7, 961,
}


!----------time limits ----------
time
{
 tmin = 0.0,
 tmax = 58605, ! Just to make your life easier, your upstream gyrotime for an rqm of 38 is 3907
}

!----------field solver set up----------
el_mag_fld
{
  type_init_b(1:3) = "math func", "math func", "math func",
  init_b_mfunc(1) = "if(x2 < 1.77781e+02, x2*(-8.89414e-07) + (1.12111e-04), if(x2 < 2.57145e+02, x2*(1.7414e-05) + (-3.14189e-03), if(x2 < 2.66152e+02, x2*(-2.11282e-04) + (5.56660e-02), if(x2 < 3.01725e+02, x2*(-3.27441e-04) + (8.6582e-02), if(x2 < 3.33973e+02, x2*(2.47632e-03) + (-7.59383e-01), if(x2 < 3.45145e+02, x2*(2.0479e-04) + (-7.53282e-04), if(x2 < 4.71278e+02, x2*(-2.06747e-04) + (1.41286e-01), if(x2 < 4.87464e+02, x2*(-1.64026e-03) + (8.16868e-01), if(x2 < 4.98577e+02, x2*(-1.78604e-04) + (1.04364e-01), if(x2 < 9.61414e+02, x2*(-3.02764e-08) + (1.53314e-02), 0.015331357447186089))))))))))",
  init_b_mfunc(2) = "if(x2 < 7.14241e+01, x2*(1.64873e-08) + (2.87027e-05), if(x2 < 1.81548e+02, x2*(-6.13511e-07) + (7.36997e-05), if(x2 < 2.56819e+02, x2*(1.39384e-06) + (-2.90731e-04), if(x2 < 3.62365e+02, x2*(-1.33485e-06) + (4.10049e-04), if(x2 < 4.13279e+02, x2*(1.84056e-05) + (-6.7432e-03), if(x2 < 4.29499e+02, x2*(-5.74427e-05) + (2.46033e-02), if(x2 < 4.71896e+02, x2*(2.15941e-05) + (-9.34292e-03), if(x2 < 4.98718e+02, x2*(-3.30115e-05) + (1.64252e-02), if(x2 < 5.61687e+02, x2*(1.97134e-06) + (-1.02133e-03), if(x2 < 9.61414e+02, x2*(1.69792e-07) + (-9.42181e-06), -9.421812867630062e-06))))))))))",
  init_b_mfunc(3) = "if(x2 < 9.15499e+01, x2*(-5.38225e-08) + (-7.24534e-06), if(x2 < 1.17577e+02, x2*(1.67884e-06) + (-1.65870e-04), if(x2 < 2.13235e+02, x2*(-1.35612e-06) + (1.90970e-04), if(x2 < 2.80062e+02, x2*(4.60034e-06) + (-1.07915e-03), if(x2 < 3.26811e+02, x2*(-9.08525e-06) + (2.75366e-03), if(x2 < 4.42523e+02, x2*(3.73620e-06) + (-1.43653e-03), if(x2 < 4.42693e+02, x2*(3.96881e-03) + (-1.75607e+00), if(x2 < 4.71737e+02, x2*(-2.63505e-05) + (1.25536e-02), if(x2 < 7.83342e+02, x2*(-4.29969e-07) + (3.25893e-04), if(x2 < 9.61414e+02, x2*(-9.01844e-08) + (5.97255e-05), 5.972549954515936e-05))))))))))",
  type_init_e(1:3) = "math func", "math func", "math func",
  init_e_mfunc(1) = "if(x2 < 1.94035e+02, x2*(-2.17687e-10) + (3.50496e-08), if(x2 < 2.22398e+02, x2*(1.38024e-08) + (-2.68535e-06), if(x2 < 2.74022e+02, x2*(-1.06319e-08) + (2.74879e-06), if(x2 < 2.97885e+02, x2*(-6.93218e-08) + (1.88311e-05), if(x2 < 3.07099e+02, x2*(3.17168e-07) + (-9.62987e-05), if(x2 < 3.6814e+02, x2*(-1.78884e-08) + (6.59704e-06), if(x2 < 4.61697e+02, x2*(-1.06470e-08) + (3.93120e-06), if(x2 < 4.88449e+02, x2*(3.91114e-08) + (-1.90421e-05), if(x2 < 5.53375e+02, x2*(-1.02722e-09) + (5.6353e-07), if(x2 < 9.61414e+02, x2*(2.0233e-11) + (-1.61026e-08), -1.610263437323999e-08))))))))))",
  init_e_mfunc(2) = "if(x2 < 2.90576e+02, x2*(3.33006e-10) + (-3.17681e-08), if(x2 < 2.95585e+02, x2*(5.26947e-07) + (-1.53053e-04), if(x2 < 3.43238e+02, x2*(-2.76522e-07) + (8.44404e-05), if(x2 < 3.91340e+02, x2*(1.88944e-07) + (-7.53252e-05), if(x2 < 4.61983e+02, x2*(6.88171e-08) + (-2.83147e-05), if(x2 < 4.89984e+02, x2*(-1.14335e-07) + (5.62985e-05), if(x2 < 6.98780e+02, x2*(-2.36239e-09) + (1.4338e-06), if(x2 < 7.15822e+02, x2*(9.04322e-09) + (-6.53621e-06), if(x2 < 9.27006e+02, x2*(-7.22531e-11) + (-1.11630e-08), if(x2 < 9.61414e+02, x2*(3.67607e-11) + (-1.12219e-07), -1.1221938621108572e-07))))))))))",
  init_e_mfunc(3) = "if(x2 < 6.52321e+01, x2*(-3.58461e-08) + (7.60764e-07), if(x2 < 2.01788e+02, x2*(5.00804e-08) + (-4.84440e-06), if(x2 < 3.04257e+02, x2*(-2.68585e-07) + (5.94583e-05), if(x2 < 3.28070e+02, x2*(8.90584e-06) + (-2.73192e-03), if(x2 < 3.8863e+02, x2*(-6.56683e-07) + (4.05259e-04), if(x2 < 4.41376e+02, x2*(-4.33814e-07) + (3.18645e-04), if(x2 < 5.12249e+02, x2*(-1.86904e-06) + (9.52120e-04), if(x2 < 6.92320e+02, x2*(3.89244e-08) + (-2.5234e-05), if(x2 < 7.94058e+02, x2*(-2.08976e-08) + (1.61819e-05), if(x2 < 9.61414e+02, x2*(3.67456e-09) + (-3.32973e-06), -3.3297345310510368e-06))))))))))", ! This is the most important component, can probably ignore others
}

!----------boundary conditions for em-fields ----------
emf_bound
{
 type(1:2,2) =  "open", "open", ! boundaries for x2
}

!----------- electro-magnetic field diagnostics ---------
diag_emf
{
 ndump_fac = 1,
 reports = 
   "b1", "b2", "b3",
   "e1", "e2", "e3",
}

!----------number of particle species----------
particles
{
  interpolation = "quadratic",
  num_species = 3,
}

!----------information for electrons----------
species
{
 name = "electrons",
 rqm=-1.0,
 num_par_x(1:2) = 3, 3, ! number of particles per cell in x and y directions
}

!----------inital proper velocities - electrons-----------------
udist
{
  use_spatial_uth = .true.,
  use_spatial_ufl = .true.,
  spatial_uth(1) = "if(x2 < 2.00044e+02, x2*(-3.96823e-06) + (5.81554e-02), if(x2 < 2.89914e+02, x2*(2.52616e-05) + (5.23082e-02), if(x2 < 3.12293e+02, x2*(2.15815e-05) + (5.33751e-02), if(x2 < 3.38367e+02, x2*(7.08193e-04) + (-1.61049e-01), if(x2 < 4.33818e+02, x2*(2.05489e-04) + (9.04995e-03), if(x2 < 4.76532e+02, x2*(1.89988e-05) + (8.99526e-02), if(x2 < 4.89506e+02, x2*(-4.16706e-03) + (2.08474e+00), if(x2 < 6.38264e+02, x2*(3.46378e-06) + (4.32486e-02), if(x2 < 8.12718e+02, x2*(-1.35892e-05) + (5.41328e-02), if(x2 < 9.61414e+02, x2*(9.58859e-06) + (3.52959e-02), 0.035295851229309436))))))))))",
  spatial_uth(2) = "if(x2 < 2.00044e+02, x2*(-3.96823e-06) + (5.81554e-02), if(x2 < 2.89914e+02, x2*(2.52616e-05) + (5.23082e-02), if(x2 < 3.12293e+02, x2*(2.15815e-05) + (5.33751e-02), if(x2 < 3.38367e+02, x2*(7.08193e-04) + (-1.61049e-01), if(x2 < 4.33818e+02, x2*(2.05489e-04) + (9.04995e-03), if(x2 < 4.76532e+02, x2*(1.89988e-05) + (8.99526e-02), if(x2 < 4.89506e+02, x2*(-4.16706e-03) + (2.08474e+00), if(x2 < 6.38264e+02, x2*(3.46378e-06) + (4.32486e-02), if(x2 < 8.12718e+02, x2*(-1.35892e-05) + (5.41328e-02), if(x2 < 9.61414e+02, x2*(9.58859e-06) + (3.52959e-02), 0.035295851229309436))))))))))",
  spatial_uth(3) = "if(x2 < 2.00044e+02, x2*(-3.96823e-06) + (5.81554e-02), if(x2 < 2.89914e+02, x2*(2.52616e-05) + (5.23082e-02), if(x2 < 3.12293e+02, x2*(2.15815e-05) + (5.33751e-02), if(x2 < 3.38367e+02, x2*(7.08193e-04) + (-1.61049e-01), if(x2 < 4.33818e+02, x2*(2.05489e-04) + (9.04995e-03), if(x2 < 4.76532e+02, x2*(1.89988e-05) + (8.99526e-02), if(x2 < 4.89506e+02, x2*(-4.16706e-03) + (2.08474e+00), if(x2 < 6.38264e+02, x2*(3.46378e-06) + (4.32486e-02), if(x2 < 8.12718e+02, x2*(-1.35892e-05) + (5.41328e-02), if(x2 < 9.61414e+02, x2*(9.58859e-06) + (3.52959e-02), 0.035295851229309436))))))))))",

  spatial_ufl(1) = "if(x2 < 3.90045e+01, x2*(-1.89112e-05) + (7.43877e-04), if(x2 < 8.41313e+01, x2*(-2.28821e-06) + (9.55050e-05), if(x2 < 1.47452e+02, x2*(1.56618e-06) + (-2.28769e-04), if(x2 < 2.83457e+02, x2*(6.15699e-06) + (-9.05694e-04), if(x2 < 3.27104e+02, x2*(-5.25056e-06) + (2.32786e-03), if(x2 < 4.11296e+02, x2*(4.37628e-06) + (-8.21121e-04), if(x2 < 4.81003e+02, x2*(-5.00955e-06) + (3.03923e-03), if(x2 < 4.91006e+02, x2*(1.52076e-05) + (-6.68527e-03), if(x2 < 7.35894e+02, x2*(7.07815e-07) + (4.34198e-04), if(x2 < 9.61414e+02, x2*(-2.25380e-07) + (1.12093e-03), 0.0011209308807727956))))))))))",
  spatial_ufl(2) = "if(x2 < 1.45705e+02, x2*(5.30448e-05) + (2.49051e-02), if(x2 < 2.72162e+02, x2*(2.78591e-05) + (2.85747e-02), if(x2 < 3.06149e+02, x2*(-8.32276e-05) + (5.88084e-02), if(x2 < 3.66381e+02, x2*(-1.37981e-04) + (7.55711e-02), if(x2 < 4.76270e+02, x2*(-1.45716e-05) + (3.03561e-02), if(x2 < 4.88303e+02, x2*(-1.82664e-03) + (8.93389e-01), if(x2 < 4.98358e+02, x2*(-1.46934e-04) + (7.31852e-02), if(x2 < 6.11867e+02, x2*(4.28265e-07) + (-2.53932e-04), if(x2 < 6.84481e+02, x2*(1.81773e-07) + (-1.03112e-04), if(x2 < 9.61414e+02, x2*(1.09118e-07) + (-5.33809e-05), -5.338088685989179e-05))))))))))",
  spatial_ufl(3) = "if(x2 < 4.59172e+01, x2*(3.46881e-06) + (3.51925e-05), if(x2 < 1.77396e+02, x2*(-5.47566e-07) + (2.19613e-04), if(x2 < 3.33394e+02, x2*(7.69154e-07) + (-1.39671e-05), if(x2 < 3.39273e+02, x2*(1.03105e-04) + (-3.4132e-02), if(x2 < 3.41850e+02, x2*(2.62674e-04) + (-8.82696e-02), if(x2 < 4.48593e+02, x2*(-2.05014e-05) + (8.53392e-03), if(x2 < 4.83083e+02, x2*(3.19077e-05) + (-1.49764e-02), if(x2 < 5.92736e+02, x2*(-4.39823e-06) + (2.56235e-03), if(x2 < 6.89183e+02, x2*(9.38697e-07) + (-6.01033e-04), if(x2 < 9.61414e+02, x2*(-3.83128e-08) + (7.23057e-05), 7.230574983577517e-05))))))))))",
}

!----------density profile for electrons----------
profile
{
  profile_type = "math func",
  math_func_expr = "if(x2 < 8.23959e+00, x2*(-7.57199e-01) + (5.44895e+01), if(x2 < 4.85013e+01, x2*(-2.6169e-01) + (5.04067e+01), if(x2 < 1.91754e+02, x2*(-1.16988e-01) + (4.33884e+01), if(x2 < 3.18465e+02, x2*(-6.14085e-02) + (3.27309e+01), if(x2 < 3.3825e+02, x2*(-4.49023e-01) + (1.56172e+02), if(x2 < 3.48995e+02, x2*(-2.59698e-02) + (1.30747e+01), if(x2 < 4.74764e+02, x2*(-1.199e-03) + (4.42979e+00), if(x2 < 4.88752e+02, x2*(-1.75575e-01) + (8.72171e+01), if(x2 < 5.95552e+02, x2*(-1.86474e-04) + (1.49580e+00), if(x2 < 9.61414e+02, x2*(6.25046e-04) + (1.01250e+00), 1.012500346326003))))))))))",
}

!----------boundary conditions for electrons----------
spe_bound
{
 type(1:2,2) = "thermal","thermal",
 uth_bnd(1:3,1,2) = 0.05821496391274283,0.05821496391274283,0.05821496391274283,
 uth_bnd(1:3,2,2) = 0.05816689794170529,0.05816689794170529,0.05816689794170529,
}

!----------diagnostic for electrons----------
diag_species
{
 ndump_fac = 1,
 reports = "charge",
 ndump_fac_pha = 1,
 ps_pmin(1:3) = -0.15, -0.15, -0.15,
 ps_pmax(1:3) = 0.15, 0.15, 0.15,
 ps_xmin(1:2) = -7, 0, ! phase space covers the entire domain. change as needed
 ps_xmax(1:2) = 7, 961,
 ps_np(1:3) = 128, 1024, 128,
 ps_nx(1:2) = 256, 1024,
 phasespaces = "p1x1", "p1x2", "p2x1", "p2x2",
}
   
!----------information for Aluminum ions----------
species
{
 name = "aluminum",
 rqm = 38,
 num_par_x(1:2) = 3, 3, ! number of particles per cell in x and y directions
}

!----------inital proper velocities Aluminum ions-----------------
udist
{
  use_spatial_uth = .true.,
  use_spatial_ufl = .true.,
  spatial_uth(1) = "if(x2 < 5.42445e+01, x2*(-9.84031e-06) + (6.85172e-03), if(x2 < 1.40587e+02, x2*(-4.22046e-06) + (6.54687e-03), if(x2 < 1.92625e+02, x2*(-8.37597e-06) + (7.13108e-03), if(x2 < 3.13209e+02, x2*(-1.23251e-06) + (5.75507e-03), if(x2 < 3.6733e+02, x2*(-9.86479e-06) + (8.45878e-03), if(x2 < 4.58856e+02, x2*(4.62839e-06) + (3.13500e-03), if(x2 < 4.81282e+02, x2*(-2.25436e-05) + (1.56030e-02), if(x2 < 4.90256e+02, x2*(-2.53825e-04) + (1.26915e-01), if(x2 < 8.01066e+02, x2*(5.28601e-07) + (2.21638e-03), if(x2 < 9.61414e+02, x2*(-1.5304e-07) + (2.76242e-03), 0.002762419651992338))))))))))",
  spatial_uth(2) = "if(x2 < 5.42445e+01, x2*(-9.84031e-06) + (6.85172e-03), if(x2 < 1.40587e+02, x2*(-4.22046e-06) + (6.54687e-03), if(x2 < 1.92625e+02, x2*(-8.37597e-06) + (7.13108e-03), if(x2 < 3.13209e+02, x2*(-1.23251e-06) + (5.75507e-03), if(x2 < 3.6733e+02, x2*(-9.86479e-06) + (8.45878e-03), if(x2 < 4.58856e+02, x2*(4.62839e-06) + (3.13500e-03), if(x2 < 4.81282e+02, x2*(-2.25436e-05) + (1.56030e-02), if(x2 < 4.90256e+02, x2*(-2.53825e-04) + (1.26915e-01), if(x2 < 8.01066e+02, x2*(5.28601e-07) + (2.21638e-03), if(x2 < 9.61414e+02, x2*(-1.5304e-07) + (2.76242e-03), 0.002762419651992338))))))))))",
  spatial_uth(3) = "if(x2 < 5.42445e+01, x2*(-9.84031e-06) + (6.85172e-03), if(x2 < 1.40587e+02, x2*(-4.22046e-06) + (6.54687e-03), if(x2 < 1.92625e+02, x2*(-8.37597e-06) + (7.13108e-03), if(x2 < 3.13209e+02, x2*(-1.23251e-06) + (5.75507e-03), if(x2 < 3.6733e+02, x2*(-9.86479e-06) + (8.45878e-03), if(x2 < 4.58856e+02, x2*(4.62839e-06) + (3.13500e-03), if(x2 < 4.81282e+02, x2*(-2.25436e-05) + (1.56030e-02), if(x2 < 4.90256e+02, x2*(-2.53825e-04) + (1.26915e-01), if(x2 < 8.01066e+02, x2*(5.28601e-07) + (2.21638e-03), if(x2 < 9.61414e+02, x2*(-1.5304e-07) + (2.76242e-03), 0.002762419651992338))))))))))",

  spatial_ufl(1) = "if(x2 < 4.99378e+01, x2*(-1.71967e-05) + (7.23080e-04), if(x2 < 1.84575e+02, x2*(2.13711e-06) + (-2.42408e-04), if(x2 < 1.91172e+02, x2*(1.39426e-05) + (-2.4214e-03), if(x2 < 2.92205e+02, x2*(5.67542e-06) + (-8.40953e-04), if(x2 < 3.90763e+02, x2*(-1.67248e-06) + (1.30614e-03), if(x2 < 4.07526e+02, x2*(2.37381e-05) + (-8.62335e-03), if(x2 < 4.41008e+02, x2*(-1.08168e-05) + (5.45865e-03), if(x2 < 7.07136e+02, x2*(1.01505e-06) + (2.40707e-04), if(x2 < 9.48739e+02, x2*(-2.07284e-07) + (1.10506e-03), if(x2 < 9.61414e+02, x2*(-6.77887e-07) + (1.55154e-03), 0.0015515414199777726))))))))))",
  spatial_ufl(2) = "if(x2 < 7.11419e+01, x2*(5.01770e-05) + (2.49866e-02), if(x2 < 1.21807e+02, x2*(5.79870e-05) + (2.4431e-02), if(x2 < 2.14541e+02, x2*(3.70932e-05) + (2.69760e-02), if(x2 < 2.85282e+02, x2*(1.35543e-05) + (3.20261e-02), if(x2 < 3.74097e+02, x2*(-1.33566e-04) + (7.39969e-02), if(x2 < 3.79045e+02, x2*(1.17026e-04) + (-1.97487e-02), if(x2 < 3.94893e+02, x2*(1.01170e-05) + (2.07746e-02), if(x2 < 4.72032e+02, x2*(-1.48110e-05) + (3.06185e-02), if(x2 < 4.90597e+02, x2*(-1.27328e-03) + (6.24657e-01), if(x2 < 9.61414e+02, x2*(3.26599e-08) + (-2.67339e-05), -2.6733916016757275e-05))))))))))",
  spatial_ufl(3) = "if(x2 < 1.84485e+02, x2*(1.32955e-07) + (1.28669e-04), if(x2 < 2.40822e+02, x2*(-2.8048e-06) + (6.7064e-04), if(x2 < 3.66146e+02, x2*(1.14841e-05) + (-2.77045e-03), if(x2 < 3.67374e+02, x2*(-6.36856e-04) + (2.34617e-01), if(x2 < 4.83312e+02, x2*(-1.44047e-05) + (5.94382e-03), if(x2 < 4.99841e+02, x2*(8.23135e-05) + (-4.08013e-02), if(x2 < 5.18423e+02, x2*(-1.58145e-05) + (8.24706e-03), if(x2 < 8.42757e+02, x2*(-1.91843e-08) + (5.83991e-05), if(x2 < 9.39194e+02, x2*(1.12495e-07) + (-5.25744e-05), if(x2 < 9.61414e+02, x2*(-4.26763e-07) + (4.53893e-04), 0.00045389302491681766))))))))))",
}

!----------density profile for Aluminum ions----------
profile
{
 profile_type = "math func",
 math_func_expr = "if(x2 < 3.22942e+02, x2*(-1.10502e-15) + (2.92203e-13), if(x2 < 3.26735e+02, x2*(2.27563e+00) + (-7.34898e+02), if(x2 < 3.39861e+02, x2*(-3.48915e-01) + (1.22635e+02), if(x2 < 3.79360e+02, x2*(-7.75266e-04) + (4.31575e+00), if(x2 < 4.07899e+02, x2*(-5.45044e-03) + (6.08932e+00), if(x2 < 4.74433e+02, x2*(8.04715e-04) + (3.53785e+00), if(x2 < 4.88711e+02, x2*(-1.75729e-01) + (8.72913e+01), if(x2 < 6.29678e+02, x2*(-3.24803e-04) + (1.56939e+00), if(x2 < 8.39156e+02, x2*(1.14732e-03) + (6.42426e-01), if(x2 < 9.61414e+02, x2*(-6.79362e-04) + (2.17530e+00), 2.1753006252902134))))))))))",
}

!----------boundary conditions for Alumium ions----------
spe_bound
{
 type(1:2,2) = "thermal", "thermal",
 uth_bnd(1:3,1,2) = 0.006929304075270467,0.006929304075270467,0.006929304075270467,
 uth_bnd(1:3,2,2) = 0.00679802522524855,0.00679802522524855,0.00679802522524855,
}

!----------diagnostic for Aluminum ions----------
diag_species
{
 ndump_fac = 1,
 reports = "charge",
 ndump_fac_pha = 1,
 ps_pmin(1:3) = -0.15, -0.15, -0.15, 
 ps_pmax(1:3) = 0.15, 0.15, 0.15,
 ps_xmin(1:2) = -7, 0,
 ps_xmax(1:2) = 7, 961,
 ps_np(1:3) = 128, 1024, 128,
 ps_nx(1:2) = 256, 1024,
 phasespaces = "p1x1", "p1x2", "p2x1", "p2x2",
}

!----------information for Silicon ions----------
species
{
 name = "silicon",
 rqm = 36,
 num_par_x(1:2) = 3, 3, ! number of particles per cell in x and y directions
}

!----------inital proper velocities Silicon ions-----------------
udist
{
  use_spatial_uth = .true.,
  use_spatial_ufl = .true.,
  spatial_uth(1) = "if(x2 < 5.42445e+01, x2*(-9.84031e-06) + (6.85172e-03), if(x2 < 1.40587e+02, x2*(-4.22046e-06) + (6.54687e-03), if(x2 < 1.92625e+02, x2*(-8.37597e-06) + (7.13108e-03), if(x2 < 3.13209e+02, x2*(-1.23251e-06) + (5.75507e-03), if(x2 < 3.6733e+02, x2*(-9.86479e-06) + (8.45878e-03), if(x2 < 4.58856e+02, x2*(4.62839e-06) + (3.13500e-03), if(x2 < 4.81282e+02, x2*(-2.25436e-05) + (1.56030e-02), if(x2 < 4.90256e+02, x2*(-2.53825e-04) + (1.26915e-01), if(x2 < 8.01066e+02, x2*(5.28601e-07) + (2.21638e-03), if(x2 < 9.61414e+02, x2*(-1.5304e-07) + (2.76242e-03), 0.002762419651992338))))))))))",
  spatial_uth(2) = "if(x2 < 5.42445e+01, x2*(-9.84031e-06) + (6.85172e-03), if(x2 < 1.40587e+02, x2*(-4.22046e-06) + (6.54687e-03), if(x2 < 1.92625e+02, x2*(-8.37597e-06) + (7.13108e-03), if(x2 < 3.13209e+02, x2*(-1.23251e-06) + (5.75507e-03), if(x2 < 3.6733e+02, x2*(-9.86479e-06) + (8.45878e-03), if(x2 < 4.58856e+02, x2*(4.62839e-06) + (3.13500e-03), if(x2 < 4.81282e+02, x2*(-2.25436e-05) + (1.56030e-02), if(x2 < 4.90256e+02, x2*(-2.53825e-04) + (1.26915e-01), if(x2 < 8.01066e+02, x2*(5.28601e-07) + (2.21638e-03), if(x2 < 9.61414e+02, x2*(-1.5304e-07) + (2.76242e-03), 0.002762419651992338))))))))))",
  spatial_uth(3) = "if(x2 < 5.42445e+01, x2*(-9.84031e-06) + (6.85172e-03), if(x2 < 1.40587e+02, x2*(-4.22046e-06) + (6.54687e-03), if(x2 < 1.92625e+02, x2*(-8.37597e-06) + (7.13108e-03), if(x2 < 3.13209e+02, x2*(-1.23251e-06) + (5.75507e-03), if(x2 < 3.6733e+02, x2*(-9.86479e-06) + (8.45878e-03), if(x2 < 4.58856e+02, x2*(4.62839e-06) + (3.13500e-03), if(x2 < 4.81282e+02, x2*(-2.25436e-05) + (1.56030e-02), if(x2 < 4.90256e+02, x2*(-2.53825e-04) + (1.26915e-01), if(x2 < 8.01066e+02, x2*(5.28601e-07) + (2.21638e-03), if(x2 < 9.61414e+02, x2*(-1.5304e-07) + (2.76242e-03), 0.002762419651992338))))))))))",

  spatial_ufl(1) = "if(x2 < 4.99378e+01, x2*(-1.71967e-05) + (7.23080e-04), if(x2 < 1.84575e+02, x2*(2.13711e-06) + (-2.42408e-04), if(x2 < 1.91172e+02, x2*(1.39426e-05) + (-2.4214e-03), if(x2 < 2.92205e+02, x2*(5.67542e-06) + (-8.40953e-04), if(x2 < 3.90763e+02, x2*(-1.67248e-06) + (1.30614e-03), if(x2 < 4.07526e+02, x2*(2.37381e-05) + (-8.62335e-03), if(x2 < 4.41008e+02, x2*(-1.08168e-05) + (5.45865e-03), if(x2 < 7.07136e+02, x2*(1.01505e-06) + (2.40707e-04), if(x2 < 9.48739e+02, x2*(-2.07284e-07) + (1.10506e-03), if(x2 < 9.61414e+02, x2*(-6.77887e-07) + (1.55154e-03), 0.0015515414199777726))))))))))",
  spatial_ufl(2) = "if(x2 < 7.11419e+01, x2*(5.01770e-05) + (2.49866e-02), if(x2 < 1.21807e+02, x2*(5.79870e-05) + (2.4431e-02), if(x2 < 2.14541e+02, x2*(3.70932e-05) + (2.69760e-02), if(x2 < 2.85282e+02, x2*(1.35543e-05) + (3.20261e-02), if(x2 < 3.74097e+02, x2*(-1.33566e-04) + (7.39969e-02), if(x2 < 3.79045e+02, x2*(1.17026e-04) + (-1.97487e-02), if(x2 < 3.94893e+02, x2*(1.01170e-05) + (2.07746e-02), if(x2 < 4.72032e+02, x2*(-1.48110e-05) + (3.06185e-02), if(x2 < 4.90597e+02, x2*(-1.27328e-03) + (6.24657e-01), if(x2 < 9.61414e+02, x2*(3.26599e-08) + (-2.67339e-05), -2.6733916016757275e-05))))))))))",
  spatial_ufl(3) = "if(x2 < 1.84485e+02, x2*(1.32955e-07) + (1.28669e-04), if(x2 < 2.40822e+02, x2*(-2.8048e-06) + (6.7064e-04), if(x2 < 3.66146e+02, x2*(1.14841e-05) + (-2.77045e-03), if(x2 < 3.67374e+02, x2*(-6.36856e-04) + (2.34617e-01), if(x2 < 4.83312e+02, x2*(-1.44047e-05) + (5.94382e-03), if(x2 < 4.99841e+02, x2*(8.23135e-05) + (-4.08013e-02), if(x2 < 5.18423e+02, x2*(-1.58145e-05) + (8.24706e-03), if(x2 < 8.42757e+02, x2*(-1.91843e-08) + (5.83991e-05), if(x2 < 9.39194e+02, x2*(1.12495e-07) + (-5.25744e-05), if(x2 < 9.61414e+02, x2*(-4.26763e-07) + (4.53893e-04), 0.00045389302491681766))))))))))",
}

!----------density profile for Silicon ions----------
profile
{
  profile_type = "math func",
  math_func_expr = "if(x2 < 6.34235e+00, x2*(-7.57053e-01) + (5.44893e+01), if(x2 < 2.63997e+01, x2*(-3.37592e-01) + (5.18289e+01), if(x2 < 5.12685e+01, x2*(-2.17970e-01) + (4.86709e+01), if(x2 < 1.66507e+02, x2*(-1.19416e-01) + (4.36182e+01), if(x2 < 2.07187e+02, x2*(-9.12309e-02) + (3.89252e+01), if(x2 < 2.97029e+02, x2*(-6.41103e-02) + (3.33062e+01), if(x2 < 3.12096e+02, x2*(-2.21031e-04) + (1.43292e+01), if(x2 < 3.23709e+02, x2*(-2.22672e-01) + (8.37551e+01), if(x2 < 3.26123e+02, x2*(-4.83746e+00) + (1.57760e+03), if(x2 < 9.61414e+02, x2*(-1.00661e-15) + (5.13018e-13), 5.13018087738239e-13))))))))))",
}

!----------boundary conditions for Silicon ions----------
spe_bound
{
 type(1:2,2) = "thermal","thermal",
 uth_bnd(1:3,1,2) = 0.006929304075270467,0.006929304075270467,0.006929304075270467,
 uth_bnd(1:3,2,2) = 0.00679802522524855,0.00679802522524855,0.00679802522524855,
}

!----------diagnostic for Silicon ions----------
diag_species
{
 ndump_fac = 1,
 reports = "charge",
 ndump_fac_pha = 1,
 ps_pmin(1:3) = -0.15, -0.15, -0.15, 
 ps_pmax(1:3) = 0.15, 0.15, 0.15,
 ps_xmin(1:2) = -7, 0,
 ps_xmax(1:2) = 7, 961,
 ps_np(1:3) = 128, 1024, 128,
 ps_nx(1:2) = 256, 1024,
 phasespaces = "p1x1", "p1x2", "p2x1", "p2x2",
}
