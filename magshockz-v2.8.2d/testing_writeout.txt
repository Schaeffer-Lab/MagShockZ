
!----------global simulation parameters----------
simulation
{
 algorithm = "cuda",
}


!--------the node configuration for this simulation--------
node_conf 
{
 node_number = 2, 1, ! number of GPUs you are using
 n_threads = 1, ! number of threads per GPU
 tile_number = 16, 128, ! n_tiles_tot should be greater than n_cells_tot / 1024 and be a power of two. Refer to osiris cuda documentation
 if_periodic(1:2) = .true., .false.,
}


!----------spatial grid----------
grid
{
 nx_p = 199, 13734, ! number of cells 
}


!----------time step and global data dump timestep number----------
time_step
{
 dt     = 0.047, ! time step in wpe^-1
 ndump  = 2435, ! number of time steps between data dumps,
}


!----------restart information----------
restart
{
! It seems like restart is broken on the GPU version
!  ndump_fac = -1,
!  ndump_time = 3590, !once/hour
!  if_restart = .false.,
!  if_remold = .true.,
}


!----------spatial limits ----------
space
{
 xmin(1:2) = -7, 0,
 xmax(1:2) = 7, 961,
 !if_move(1:2) = .false., .false.,
 !move_u = -0.01,
}


!----------time limits ----------
time
{
 tmin = 0.0,
 tmax = 58605, ! Just to make your life easier, your upstream gyrotime for an rqm of 38 is 3907
}

!----------field solver set up----------
el_mag_fld
{
  type_init_b(1:3) = "math func", "math func", "math func",
  init_b_mfunc(1) = "if(x2 < 2.13585e+02, x2*(7.57964e-07) + (1.2297e-05), if(x2 < 2.58553e+02, x2*(2.65035e-05) + (-5.48658e-03), if(x2 < 3.02763e+02, x2*(-2.83249e-04) + (7.4601e-02), if(x2 < 3.29488e+02, x2*(2.56153e-03) + (-7.86692e-01), if(x2 < 3.36800e+02, x2*(1.83124e-03) + (-5.46071e-01), if(x2 < 4.69488e+02, x2*(-1.93707e-04) + (1.35933e-01), if(x2 < 4.81433e+02, x2*(-1.50143e-03) + (7.49891e-01), if(x2 < 4.88361e+02, x2*(-1.67531e-03) + (8.33605e-01), if(x2 < 7.02912e+02, x2*(-7.77521e-07) + (1.58277e-02), if(x2 < 9.61414e+02, x2*(1.25671e-07) + (1.51928e-02), 0.015192820582558893))))))))))",
  init_b_mfunc(2) = "if(x2 < 3.60312e+02, x2*(-3.01254e-07) + (4.87585e-05), if(x2 < 3.90441e+02, x2*(2.88498e-05) + (-1.04547e-02), if(x2 < 4.35352e+02, x2*(-1.68624e-05) + (7.39322e-03), if(x2 < 4.7527e+02, x2*(2.32507e-05) + (-1.00701e-02), if(x2 < 4.84863e+02, x2*(-9.75088e-05) + (4.73233e-02), if(x2 < 6.79612e+02, x2*(3.02297e-07) + (-1.0172e-04), if(x2 < 7.06689e+02, x2*(1.02135e-06) + (-5.90397e-04), if(x2 < 8.33893e+02, x2*(-6.39527e-08) + (1.76574e-04), if(x2 < 8.588e+02, x2*(-4.9669e-07) + (5.37431e-04), if(x2 < 9.61414e+02, x2*(6.41692e-07) + (-4.40211e-04), -0.00044021134739648157))))))))))",
  init_b_mfunc(3) = "if(x2 < 2.25893e+02, x2*(-3.79588e-07) + (1.90717e-05), if(x2 < 2.76951e+02, x2*(6.2313e-06) + (-1.47428e-03), if(x2 < 3.31398e+02, x2*(-1.10215e-05) + (3.30388e-03), if(x2 < 3.87404e+02, x2*(1.20493e-05) + (-4.34171e-03), if(x2 < 4.19805e+02, x2*(-1.92810e-05) + (7.79577e-03), if(x2 < 4.42479e+02, x2*(3.96095e-05) + (-1.69268e-02), if(x2 < 5.11281e+02, x2*(-8.65152e-06) + (4.42774e-03), if(x2 < 5.54589e+02, x2*(2.49474e-06) + (-1.27114e-03), if(x2 < 6.84603e+02, x2*(-7.47732e-07) + (5.27103e-04), if(x2 < 9.61414e+02, x2*(-1.73036e-07) + (1.33664e-04), 0.00013366402720273705))))))))))",
  type_init_e(1:3) = "math func", "math func", "math func",
  init_e_mfunc(1) = "if(x2 < 2.24643e+02, x2*(8.95096e-09) + (-4.08171e-07), if(x2 < 2.77393e+02, x2*(-7.51078e-08) + (1.84750e-05), if(x2 < 2.98972e+02, x2*(-6.57989e-07) + (1.80162e-04), if(x2 < 3.18329e+02, x2*(1.74431e-06) + (-5.38058e-04), if(x2 < 3.42531e+02, x2*(-6.28397e-07) + (2.17243e-04), if(x2 < 4.79157e+02, x2*(-7.93647e-08) + (2.91826e-05), if(x2 < 4.87586e+02, x2*(1.01407e-06) + (-4.94744e-04), if(x2 < 4.98916e+02, x2*(2.70615e-08) + (-1.34926e-05), if(x2 < 8.62046e+02, x2*(-1.36141e-11) + (1.56769e-08), if(x2 < 9.61414e+02, x2*(6.66362e-11) + (-5.35025e-08), -5.350247718242883e-08))))))))))",
  init_e_mfunc(2) = "if(x2 < 3.18203e+02, x2*(1.65884e-09) + (-1.3486e-07), if(x2 < 3.23484e+02, x2*(-7.98907e-06) + (2.54254e-03), if(x2 < 3.48336e+02, x2*(-3.07489e-06) + (9.52882e-04), if(x2 < 3.80613e+02, x2*(3.01780e-06) + (-1.16943e-03), if(x2 < 4.61749e+02, x2*(6.33758e-07) + (-2.62028e-04), if(x2 < 5.32756e+02, x2*(-5.01121e-07) + (2.62001e-04), if(x2 < 6.39421e+02, x2*(5.35306e-08) + (-3.34924e-05), if(x2 < 7.27539e+02, x2*(-1.99811e-08) + (1.35125e-05), if(x2 < 7.6505e+02, x2*(7.36614e-09) + (-6.38367e-06), if(x2 < 9.61414e+02, x2*(6.00511e-11) + (-7.94149e-07), -7.941485870383099e-07))))))))))",
  init_e_mfunc(3) = "if(x2 < 1.21509e+02, x2*(-1.75535e-07) + (7.79432e-06), if(x2 < 2.02758e+02, x2*(1.08745e-06) + (-1.45670e-04), if(x2 < 2.90925e+02, x2*(-3.47494e-06) + (7.7939e-04), if(x2 < 3.14873e+02, x2*(2.68077e-05) + (-8.03061e-03), if(x2 < 3.33606e+02, x2*(9.09384e-05) + (-2.82236e-02), if(x2 < 3.73967e+02, x2*(-1.46066e-05) + (6.98682e-03), if(x2 < 4.06738e+02, x2*(-3.02897e-06) + (2.65715e-03), if(x2 < 4.68755e+02, x2*(-6.46689e-06) + (4.05549e-03), if(x2 < 4.92875e+02, x2*(-4.29126e-05) + (2.11396e-02), if(x2 < 9.61414e+02, x2*(3.43535e-08) + (-2.78779e-05), -2.7877906259062702e-05))))))))))", ! This is the most important component, can probably ignore others
}

!----------boundary conditions for em-fields ----------
emf_bound
{
 type(1:2,2) =  "open", "open", ! boundaries for x2
}

!----------- electro-magnetic field diagnostics ---------
diag_emf
{
 ndump_fac = 1,
 reports = 
   "b1", "b2", "b3",
   "e1", "e2", "e3",
}

!----------number of particle species----------
particles
{
  interpolation = "cubic",
  num_species = 3,
}

!----------information for electrons----------
species
{
 name = "electrons",
 rqm=-1.0,
 num_par_x(1:2) = 5, 5, ! number of particles per cell in x and y directions
}

!----------inital proper velocities - electrons-----------------
udist
{
  use_spatial_uth = .true.,
  use_spatial_ufl = .true.,
  spatial_uth(1) = "if(x2 < 2.21434e+02, x2*(-3.80325e-06) + (5.81537e-02), if(x2 < 3.24781e+02, x2*(4.5388e-05) + (4.72611e-02), if(x2 < 3.3345e+02, x2*(1.94172e-03) + (-5.68632e-01), if(x2 < 4.60152e+02, x2*(1.79493e-04) + (1.89824e-02), if(x2 < 4.82422e+02, x2*(-5.71841e-04) + (3.64710e-01), if(x2 < 4.83679e+02, x2*(-2.16852e-02) + (1.05503e+01), if(x2 < 4.92163e+02, x2*(-2.00039e-03) + (1.02913e+00), if(x2 < 5.9356e+02, x2*(1.09019e-05) + (3.92469e-02), if(x2 < 7.7576e+02, x2*(-1.25115e-05) + (5.31442e-02), if(x2 < 9.61414e+02, x2*(4.11215e-06) + (4.02482e-02), 0.04024820886302671))))))))))",
  spatial_uth(2) = "if(x2 < 2.21434e+02, x2*(-3.80325e-06) + (5.81537e-02), if(x2 < 3.24781e+02, x2*(4.5388e-05) + (4.72611e-02), if(x2 < 3.3345e+02, x2*(1.94172e-03) + (-5.68632e-01), if(x2 < 4.60152e+02, x2*(1.79493e-04) + (1.89824e-02), if(x2 < 4.82422e+02, x2*(-5.71841e-04) + (3.64710e-01), if(x2 < 4.83679e+02, x2*(-2.16852e-02) + (1.05503e+01), if(x2 < 4.92163e+02, x2*(-2.00039e-03) + (1.02913e+00), if(x2 < 5.9356e+02, x2*(1.09019e-05) + (3.92469e-02), if(x2 < 7.7576e+02, x2*(-1.25115e-05) + (5.31442e-02), if(x2 < 9.61414e+02, x2*(4.11215e-06) + (4.02482e-02), 0.04024820886302671))))))))))",
  spatial_uth(3) = "if(x2 < 2.21434e+02, x2*(-3.80325e-06) + (5.81537e-02), if(x2 < 3.24781e+02, x2*(4.5388e-05) + (4.72611e-02), if(x2 < 3.3345e+02, x2*(1.94172e-03) + (-5.68632e-01), if(x2 < 4.60152e+02, x2*(1.79493e-04) + (1.89824e-02), if(x2 < 4.82422e+02, x2*(-5.71841e-04) + (3.64710e-01), if(x2 < 4.83679e+02, x2*(-2.16852e-02) + (1.05503e+01), if(x2 < 4.92163e+02, x2*(-2.00039e-03) + (1.02913e+00), if(x2 < 5.9356e+02, x2*(1.09019e-05) + (3.92469e-02), if(x2 < 7.7576e+02, x2*(-1.25115e-05) + (5.31442e-02), if(x2 < 9.61414e+02, x2*(4.11215e-06) + (4.02482e-02), 0.04024820886302671))))))))))",

  spatial_ufl(1) = "if(x2 < 3.05193e+01, x2*(-2.59000e-05) + (7.96955e-04), if(x2 < 1.45365e+02, x2*(-3.51784e-07) + (1.72396e-05), if(x2 < 2.72525e+02, x2*(6.21615e-06) + (-9.3751e-04), if(x2 < 2.84513e+02, x2*(1.29742e-05) + (-2.77924e-03), if(x2 < 3.34570e+02, x2*(-8.20375e-06) + (3.24615e-03), if(x2 < 3.40318e+02, x2*(4.06755e-05) + (-1.31074e-02), if(x2 < 3.99844e+02, x2*(3.16804e-06) + (-3.4294e-04), if(x2 < 4.77937e+02, x2*(-2.14093e-06) + (1.77982e-03), if(x2 < 7.84495e+02, x2*(7.02291e-07) + (4.20938e-04), if(x2 < 9.61414e+02, x2*(-4.42524e-07) + (1.31904e-03), 0.001319040506356326))))))))))",
  spatial_ufl(2) = "if(x2 < 2.16369e+02, x2*(4.67494e-05) + (2.52598e-02), if(x2 < 2.69414e+02, x2*(6.53065e-06) + (3.3962e-02), if(x2 < 2.99947e+02, x2*(-5.00267e-05) + (4.91993e-02), if(x2 < 3.65376e+02, x2*(-1.40769e-04) + (7.64171e-02), if(x2 < 4.49901e+02, x2*(-1.15077e-05) + (2.91882e-02), if(x2 < 4.74016e+02, x2*(-6.03556e-06) + (2.67263e-02), if(x2 < 4.89887e+02, x2*(-1.50105e-03) + (7.35386e-01), if(x2 < 5.78031e+02, x2*(-5.89673e-07) + (3.30449e-04), if(x2 < 6.75094e+02, x2*(2.97562e-07) + (-1.82402e-04), if(x2 < 9.61414e+02, x2*(1.19023e-07) + (-6.18706e-05), -6.187062246848968e-05))))))))))",
  spatial_ufl(3) = "if(x2 < 3.01149e+02, x2*(6.74731e-07) + (7.50082e-05), if(x2 < 3.23757e+02, x2*(-2.31744e-05) + (7.25715e-03), if(x2 < 3.53006e+02, x2*(6.92943e-05) + (-2.26802e-02), if(x2 < 3.54362e+02, x2*(-7.22520e-05) + (2.72865e-02), if(x2 < 3.65597e+02, x2*(-7.10172e-05) + (2.68489e-02), if(x2 < 4.4234e+02, x2*(-1.76984e-05) + (7.35572e-03), if(x2 < 4.99718e+02, x2*(1.58329e-05) + (-7.47652e-03), if(x2 < 5.71557e+02, x2*(-6.24541e-06) + (3.55643e-03), if(x2 < 7.62922e+02, x2*(3.27777e-07) + (-2.00521e-04), if(x2 < 9.61414e+02, x2*(-7.90096e-08) + (1.09825e-04), 0.00010982533574022376))))))))))",
}

!----------density profile for electrons----------
profile
{
  profile_type(1:2) = "uniform", "piecewise-linear",
  num_x = 57,
  x(1:57,2) = 0., 16.58, 33.15, 49.73, 66.30, 82.88, 99.46, 116.03, 132.61, 149.18, 165.76, 182.34, 198.91, 215.49, 232.07, 248.64, 265.22, 281.79, 298.37, 314.95, 331.52, 348.1, 364.67, 381.25, 397.83, 414.40, 430.98, 447.55, 464.13, 480.71, 497.28, 513.86, 530.44, 547.01, 563.59, 580.16, 596.74, 613.32, 629.89, 646.47, 663.04, 679.62, 696.2, 712.77, 729.35, 745.92, 762.50, 779.08, 795.65, 812.23, 828.81, 845.38, 861.96, 878.53, 895.11, 911.69, 928.26,
  fx(1:57,2) = 54.49, 47.27, 42.15, 38.53, 35.93, 34.05, 32.17, 30.13, 28.04, 26.08, 24.19, 22.51, 21., 19.6, 18.60, 17.52, 16.47, 15.51, 14.24, 14.09, 7.68, 4.09, 4.01, 4.03, 3.92, 3.87, 3.89, 3.88, 3.92, 3.09, 1.40, 1.39, 1.4, 1.40, 1.40, 1.38, 1.37, 1.36, 1.36, 1.38, 1.39, 1.42, 1.44, 1.47, 1.48, 1.51, 1.53, 1.54, 1.55, 1.57, 1.59, 1.59, 1.59, 1.59, 1.58, 1.55, 1.53,
}

!----------boundary conditions for electrons----------
spe_bound
{
 type(1:2,2) = "thermal","thermal",
 uth_bnd(1:3,1,2) = 0.05821496391274283,0.05821496391274283,0.05821496391274283,
 uth_bnd(1:3,2,2) = 0.05816689794170529,0.05816689794170529,0.05816689794170529,
}

!----------diagnostic for electrons----------
diag_species
{
 ndump_fac = 1,
 reports = "charge",
 ndump_fac_pha = 1,
 ps_pmin(1:3) = -0.15, -0.15, -0.15,
 ps_pmax(1:3) = 0.15, 0.15, 0.15,
 ps_xmin(1:2) = -7, 0, ! phase space covers the entire domain. change as needed
 ps_xmax(1:2) = 7, 961,
 ps_np(1:3) = 128, 1024, 128,
 ps_nx(1:2) = 256, 1024,
 phasespaces = "p1x1", "p1x2", "p2x1", "p2x2",
}
   
!----------information for Aluminum ions----------
species
{
 name = "aluminum",
 rqm = 38,
 num_par_x(1:2) = 5, 5, ! number of particles per cell in x and y directions
}

!----------inital proper velocities Aluminum ions-----------------
udist
{
  use_spatial_uth = .true.,
  use_spatial_ufl = .true.,
  spatial_uth(1) = "if(x2 < 9.17616e+01, x2*(-7.04798e-06) + (6.7856e-03), if(x2 < 3.10175e+02, x2*(-4.90663e-06) + (6.58910e-03), if(x2 < 3.25814e+02, x2*(6.80066e-05) + (-1.60267e-02), if(x2 < 3.5356e+02, x2*(-5.0813e-05) + (2.26864e-02), if(x2 < 4.36129e+02, x2*(5.04321e-06) + (2.93791e-03), if(x2 < 4.73877e+02, x2*(5.8212e-06) + (2.59860e-03), if(x2 < 4.84299e+02, x2*(-2.24639e-04) + (1.11808e-01), if(x2 < 5.19494e+02, x2*(-1.53777e-05) + (1.04633e-02), if(x2 < 8.50511e+02, x2*(5.70474e-07) + (2.17829e-03), if(x2 < 9.61414e+02, x2*(-6.31109e-07) + (3.20025e-03), 0.003200253805867034))))))))))",
  spatial_uth(2) = "if(x2 < 9.17616e+01, x2*(-7.04798e-06) + (6.7856e-03), if(x2 < 3.10175e+02, x2*(-4.90663e-06) + (6.58910e-03), if(x2 < 3.25814e+02, x2*(6.80066e-05) + (-1.60267e-02), if(x2 < 3.5356e+02, x2*(-5.0813e-05) + (2.26864e-02), if(x2 < 4.36129e+02, x2*(5.04321e-06) + (2.93791e-03), if(x2 < 4.73877e+02, x2*(5.8212e-06) + (2.59860e-03), if(x2 < 4.84299e+02, x2*(-2.24639e-04) + (1.11808e-01), if(x2 < 5.19494e+02, x2*(-1.53777e-05) + (1.04633e-02), if(x2 < 8.50511e+02, x2*(5.70474e-07) + (2.17829e-03), if(x2 < 9.61414e+02, x2*(-6.31109e-07) + (3.20025e-03), 0.003200253805867034))))))))))",
  spatial_uth(3) = "if(x2 < 9.17616e+01, x2*(-7.04798e-06) + (6.7856e-03), if(x2 < 3.10175e+02, x2*(-4.90663e-06) + (6.58910e-03), if(x2 < 3.25814e+02, x2*(6.80066e-05) + (-1.60267e-02), if(x2 < 3.5356e+02, x2*(-5.0813e-05) + (2.26864e-02), if(x2 < 4.36129e+02, x2*(5.04321e-06) + (2.93791e-03), if(x2 < 4.73877e+02, x2*(5.8212e-06) + (2.59860e-03), if(x2 < 4.84299e+02, x2*(-2.24639e-04) + (1.11808e-01), if(x2 < 5.19494e+02, x2*(-1.53777e-05) + (1.04633e-02), if(x2 < 8.50511e+02, x2*(5.70474e-07) + (2.17829e-03), if(x2 < 9.61414e+02, x2*(-6.31109e-07) + (3.20025e-03), 0.003200253805867034))))))))))",

  spatial_ufl(1) = "if(x2 < 4.26154e+01, x2*(-2.03129e-05) + (7.58654e-04), if(x2 < 1.86174e+02, x2*(1.65615e-06) + (-1.77566e-04), if(x2 < 2.59058e+02, x2*(8.57961e-06) + (-1.46653e-03), if(x2 < 3.80578e+02, x2*(-6.78871e-07) + (9.31953e-04), if(x2 < 4.11097e+02, x2*(1.25041e-05) + (-4.0852e-03), if(x2 < 4.34167e+02, x2*(-1.68903e-05) + (7.99876e-03), if(x2 < 5.62539e+02, x2*(1.31394e-06) + (9.50676e-05), if(x2 < 7.32717e+02, x2*(7.55233e-07) + (4.09361e-04), if(x2 < 7.59558e+02, x2*(-9.22279e-07) + (1.63850e-03), if(x2 < 9.61414e+02, x2*(-1.33609e-07) + (1.03946e-03), 0.0010394626143979816))))))))))",
  spatial_ufl(2) = "if(x2 < 9.56617e+01, x2*(5.72342e-05) + (2.47879e-02), if(x2 < 2.55576e+02, x2*(3.77175e-05) + (2.66549e-02), if(x2 < 3.22478e+02, x2*(-5.65068e-05) + (5.07364e-02), if(x2 < 3.44432e+02, x2*(-2.85845e-04) + (1.24693e-01), if(x2 < 4.75579e+02, x2*(-2.52874e-05) + (3.49486e-02), if(x2 < 4.88811e+02, x2*(-1.68509e-03) + (8.24315e-01), if(x2 < 4.96901e+02, x2*(-7.69588e-05) + (3.82428e-02), if(x2 < 5.77546e+02, x2*(-7.50610e-08) + (3.92073e-05), if(x2 < 6.56810e+02, x2*(-3.19734e-07) + (1.80517e-04), if(x2 < 9.61414e+02, x2*(1.72705e-07) + (-1.42922e-04), -0.000142922148237262))))))))))",
  spatial_ufl(3) = "if(x2 < 6.95605e+01, x2*(2.61152e-06) + (4.33212e-05), if(x2 < 1.63529e+02, x2*(-1.65692e-06) + (3.40237e-04), if(x2 < 2.86331e+02, x2*(1.70531e-06) + (-2.09587e-04), if(x2 < 3.52724e+02, x2*(1.72272e-05) + (-4.65399e-03), if(x2 < 4.05739e+02, x2*(-2.86188e-05) + (1.15170e-02), if(x2 < 4.24928e+02, x2*(3.82419e-06) + (-1.64636e-03), if(x2 < 4.80531e+02, x2*(-2.04410e-05) + (8.6646e-03), if(x2 < 4.94090e+02, x2*(9.24137e-05) + (-4.55656e-02), if(x2 < 6.87209e+02, x2*(-3.32027e-07) + (2.59156e-04), if(x2 < 9.61414e+02, x2*(8.8122e-08) + (-2.95738e-05), -2.957375750587737e-05))))))))))",
}

!----------density profile for Aluminum ions----------
profile
{
  profile_type(1:2) = "uniform", "piecewise-linear",
  num_x = 57,
  x(1:57,2) = 0., 16.58, 33.15, 49.73, 66.30, 82.88, 99.46, 116.03, 132.61, 149.18, 165.76, 182.34, 198.91, 215.49, 232.07, 248.64, 265.22, 281.79, 298.37, 314.95, 331.52, 348.1, 364.67, 381.25, 397.83, 414.40, 430.98, 447.55, 464.13, 480.71, 497.28, 513.86, 530.44, 547.01, 563.59, 580.16, 596.74, 613.32, 629.89, 646.47, 663.04, 679.62, 696.2, 712.77, 729.35, 745.92, 762.50, 779.08, 795.65, 812.23, 828.81, 845.38, 861.96, 878.53, 895.11, 911.69, 928.26,
  fx(1:57,2) = 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 7.68, 4.09, 4.01, 4.03, 3.92, 3.87, 3.89, 3.88, 3.92, 3.09, 1.40, 1.39, 1.4, 1.40, 1.40, 1.38, 1.37, 1.36, 1.36, 1.38, 1.39, 1.42, 1.44, 1.47, 1.48, 1.51, 1.53, 1.54, 1.55, 1.57, 1.59, 1.59, 1.59, 1.59, 1.58, 1.55, 1.53,
}

!----------boundary conditions for Alumium ions----------
spe_bound
{
 type(1:2,2) = "thermal", "thermal",
 uth_bnd(1:3,1,2) = 0.006929304075270467,0.006929304075270467,0.006929304075270467,
 uth_bnd(1:3,2,2) = 0.00679802522524855,0.00679802522524855,0.00679802522524855,
}

!----------diagnostic for Aluminum ions----------
diag_species
{
 ndump_fac = 1,
 reports = "charge",
 ndump_fac_pha = 1,
 ps_pmin(1:3) = -0.15, -0.15, -0.15, 
 ps_pmax(1:3) = 0.15, 0.15, 0.15,
 ps_xmin(1:2) = -7, 0,
 ps_xmax(1:2) = 7, 961,
 ps_np(1:3) = 128, 1024, 128,
 ps_nx(1:2) = 256, 1024,
 phasespaces = "p1x1", "p1x2", "p2x1", "p2x2",
}

!----------information for Silicon ions----------
species
{
 name = "silicon",
 rqm = 36,
 num_par_x(1:2) = 5, 5, ! number of particles per cell in x and y directions
}

!----------inital proper velocities Silicon ions-----------------
udist
{
  use_spatial_uth = .true.,
  use_spatial_ufl = .true.,
  spatial_uth(1) = "if(x2 < 9.17616e+01, x2*(-7.04798e-06) + (6.7856e-03), if(x2 < 3.10175e+02, x2*(-4.90663e-06) + (6.58910e-03), if(x2 < 3.25814e+02, x2*(6.80066e-05) + (-1.60267e-02), if(x2 < 3.5356e+02, x2*(-5.0813e-05) + (2.26864e-02), if(x2 < 4.36129e+02, x2*(5.04321e-06) + (2.93791e-03), if(x2 < 4.73877e+02, x2*(5.8212e-06) + (2.59860e-03), if(x2 < 4.84299e+02, x2*(-2.24639e-04) + (1.11808e-01), if(x2 < 5.19494e+02, x2*(-1.53777e-05) + (1.04633e-02), if(x2 < 8.50511e+02, x2*(5.70474e-07) + (2.17829e-03), if(x2 < 9.61414e+02, x2*(-6.31109e-07) + (3.20025e-03), 0.003200253805867034))))))))))",
  spatial_uth(2) = "if(x2 < 9.17616e+01, x2*(-7.04798e-06) + (6.7856e-03), if(x2 < 3.10175e+02, x2*(-4.90663e-06) + (6.58910e-03), if(x2 < 3.25814e+02, x2*(6.80066e-05) + (-1.60267e-02), if(x2 < 3.5356e+02, x2*(-5.0813e-05) + (2.26864e-02), if(x2 < 4.36129e+02, x2*(5.04321e-06) + (2.93791e-03), if(x2 < 4.73877e+02, x2*(5.8212e-06) + (2.59860e-03), if(x2 < 4.84299e+02, x2*(-2.24639e-04) + (1.11808e-01), if(x2 < 5.19494e+02, x2*(-1.53777e-05) + (1.04633e-02), if(x2 < 8.50511e+02, x2*(5.70474e-07) + (2.17829e-03), if(x2 < 9.61414e+02, x2*(-6.31109e-07) + (3.20025e-03), 0.003200253805867034))))))))))",
  spatial_uth(3) = "if(x2 < 9.17616e+01, x2*(-7.04798e-06) + (6.7856e-03), if(x2 < 3.10175e+02, x2*(-4.90663e-06) + (6.58910e-03), if(x2 < 3.25814e+02, x2*(6.80066e-05) + (-1.60267e-02), if(x2 < 3.5356e+02, x2*(-5.0813e-05) + (2.26864e-02), if(x2 < 4.36129e+02, x2*(5.04321e-06) + (2.93791e-03), if(x2 < 4.73877e+02, x2*(5.8212e-06) + (2.59860e-03), if(x2 < 4.84299e+02, x2*(-2.24639e-04) + (1.11808e-01), if(x2 < 5.19494e+02, x2*(-1.53777e-05) + (1.04633e-02), if(x2 < 8.50511e+02, x2*(5.70474e-07) + (2.17829e-03), if(x2 < 9.61414e+02, x2*(-6.31109e-07) + (3.20025e-03), 0.003200253805867034))))))))))",

  spatial_ufl(1) = "if(x2 < 4.26154e+01, x2*(-2.03129e-05) + (7.58654e-04), if(x2 < 1.86174e+02, x2*(1.65615e-06) + (-1.77566e-04), if(x2 < 2.59058e+02, x2*(8.57961e-06) + (-1.46653e-03), if(x2 < 3.80578e+02, x2*(-6.78871e-07) + (9.31953e-04), if(x2 < 4.11097e+02, x2*(1.25041e-05) + (-4.0852e-03), if(x2 < 4.34167e+02, x2*(-1.68903e-05) + (7.99876e-03), if(x2 < 5.62539e+02, x2*(1.31394e-06) + (9.50676e-05), if(x2 < 7.32717e+02, x2*(7.55233e-07) + (4.09361e-04), if(x2 < 7.59558e+02, x2*(-9.22279e-07) + (1.63850e-03), if(x2 < 9.61414e+02, x2*(-1.33609e-07) + (1.03946e-03), 0.0010394626143979816))))))))))",
  spatial_ufl(2) = "if(x2 < 9.56617e+01, x2*(5.72342e-05) + (2.47879e-02), if(x2 < 2.55576e+02, x2*(3.77175e-05) + (2.66549e-02), if(x2 < 3.22478e+02, x2*(-5.65068e-05) + (5.07364e-02), if(x2 < 3.44432e+02, x2*(-2.85845e-04) + (1.24693e-01), if(x2 < 4.75579e+02, x2*(-2.52874e-05) + (3.49486e-02), if(x2 < 4.88811e+02, x2*(-1.68509e-03) + (8.24315e-01), if(x2 < 4.96901e+02, x2*(-7.69588e-05) + (3.82428e-02), if(x2 < 5.77546e+02, x2*(-7.50610e-08) + (3.92073e-05), if(x2 < 6.56810e+02, x2*(-3.19734e-07) + (1.80517e-04), if(x2 < 9.61414e+02, x2*(1.72705e-07) + (-1.42922e-04), -0.000142922148237262))))))))))",
  spatial_ufl(3) = "if(x2 < 6.95605e+01, x2*(2.61152e-06) + (4.33212e-05), if(x2 < 1.63529e+02, x2*(-1.65692e-06) + (3.40237e-04), if(x2 < 2.86331e+02, x2*(1.70531e-06) + (-2.09587e-04), if(x2 < 3.52724e+02, x2*(1.72272e-05) + (-4.65399e-03), if(x2 < 4.05739e+02, x2*(-2.86188e-05) + (1.15170e-02), if(x2 < 4.24928e+02, x2*(3.82419e-06) + (-1.64636e-03), if(x2 < 4.80531e+02, x2*(-2.04410e-05) + (8.6646e-03), if(x2 < 4.94090e+02, x2*(9.24137e-05) + (-4.55656e-02), if(x2 < 6.87209e+02, x2*(-3.32027e-07) + (2.59156e-04), if(x2 < 9.61414e+02, x2*(8.8122e-08) + (-2.95738e-05), -2.957375750587737e-05))))))))))",
}

!----------density profile for Silicon ions----------
profile
{
  profile_type(1:2) = "uniform", "piecewise-linear",
  num_x = 57,
  x(1:57,2) = 0., 16.58, 33.15, 49.73, 66.30, 82.88, 99.46, 116.03, 132.61, 149.18, 165.76, 182.34, 198.91, 215.49, 232.07, 248.64, 265.22, 281.79, 298.37, 314.95, 331.52, 348.1, 364.67, 381.25, 397.83, 414.40, 430.98, 447.55, 464.13, 480.71, 497.28, 513.86, 530.44, 547.01, 563.59, 580.16, 596.74, 613.32, 629.89, 646.47, 663.04, 679.62, 696.2, 712.77, 729.35, 745.92, 762.50, 779.08, 795.65, 812.23, 828.81, 845.38, 861.96, 878.53, 895.11, 911.69, 928.26,
  fx(1:57,2) = 54.49, 47.27, 42.15, 38.53, 35.93, 34.05, 32.17, 30.13, 28.04, 26.08, 24.19, 22.51, 21., 19.6, 18.60, 17.52, 16.47, 15.51, 14.24, 14.09, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
}

!----------boundary conditions for Silicon ions----------
spe_bound
{
 type(1:2,2) = "thermal","thermal",
 uth_bnd(1:3,1,2) = 0.006929304075270467,0.006929304075270467,0.006929304075270467,
 uth_bnd(1:3,2,2) = 0.00679802522524855,0.00679802522524855,0.00679802522524855,
}

!----------diagnostic for Silicon ions----------
diag_species
{
 ndump_fac = 1,
 reports = "charge",
 ndump_fac_pha = 1,
 ps_pmin(1:3) = -0.15, -0.15, -0.15, 
 ps_pmax(1:3) = 0.15, 0.15, 0.15,
 ps_xmin(1:2) = -7, 0,
 ps_xmax(1:2) = 7, 961,
 ps_np(1:3) = 128, 1024, 128,
 ps_nx(1:2) = 256, 1024,
 phasespaces = "p1x1", "p1x2", "p2x1", "p2x2",
}

!--------Current smoothing----------
smooth
{
  type = "none",
  order = 1,
}
