
!----------global simulation parameters----------
simulation
{
 algorithm = "cuda",
}


!--------the node configuration for this simulation--------
node_conf 
{
 node_number = 2, 1, ! number of GPUs you are using
 n_threads = 1, ! number of threads per GPU
 tile_number = 32, 64, ! n_tiles_tot should be greater than n_cells_tot / 1024 and be a power of two. Refer to osiris cuda documentation
 if_periodic(1:2) = .true., .false.,
}


!----------spatial grid----------
grid
{
 nx_p = 199, 13734, ! number of cells 
}


!----------time step and global data dump timestep number----------
time_step
{
 dt     = 0.04900249993622774, ! time step in wpe^-1
 ndump  = 2335, ! number of time steps between data dumps,
}


!----------restart information----------
restart
{
! It seems like restart is broken on the GPU version
!  ndump_fac = -1,
!  ndump_time = 3590, !once/hour
!  if_restart = .false.,
!  if_remold = .true.,
}


!----------spatial limits ----------
space
{
 xmin(1:2) = -7, 0,
 xmax(1:2) = 7, 961,
}


!----------time limits ----------
time
{
 tmin = 0.0,
 tmax = 58605, ! Just to make your life easier, your upstream gyrotime for an rqm of 38 is 3907
}

!----------field solver set up----------
el_mag_fld
{
  type_init_b(1:3) = "math func", "math func", "math func",
  init_b_mfunc(1) = "if(x2 < 1.84628e+02, x2*(-7.11933e-07) + (1.04477e-04), if(x2 < 2.4445e+02, x2*(1.90230e-05) + (-3.53915e-03), if(x2 < 2.52839e+02, x2*(2.34463e-04) + (-5.62034e-02), if(x2 < 3.00926e+02, x2*(-3.27864e-04) + (8.59747e-02), if(x2 < 3.28500e+02, x2*(2.42746e-03) + (-7.43175e-01), if(x2 < 3.39064e+02, x2*(1.57627e-03) + (-4.6356e-01), if(x2 < 3.85001e+02, x2*(-2.02925e-04) + (1.39702e-01), if(x2 < 4.72747e+02, x2*(-2.00759e-04) + (1.38869e-01), if(x2 < 4.84151e+02, x2*(-2.48732e-03) + (1.21983e+00), if(x2 < 9.61414e+02, x2*(-8.91804e-07) + (1.60259e-02), 0.016025903220448254))))))))))",
  init_b_mfunc(2) = "if(x2 < 4.34116e+01, x2*(-1.16457e-07) + (3.33914e-05), if(x2 < 1.44193e+02, x2*(-4.01543e-07) + (4.57674e-05), if(x2 < 3.31417e+02, x2*(2.42615e-07) + (-4.71154e-05), if(x2 < 3.73410e+02, x2*(-2.91028e-06) + (9.97809e-04), if(x2 < 4.07470e+02, x2*(3.56471e-05) + (-1.33999e-02), if(x2 < 4.21994e+02, x2*(-8.58993e-05) + (3.61266e-02), if(x2 < 4.39073e+02, x2*(2.45693e-05) + (-1.04904e-02), if(x2 < 4.76574e+02, x2*(1.20768e-05) + (-5.00530e-03), if(x2 < 4.95020e+02, x2*(-3.80327e-05) + (1.88756e-02), if(x2 < 9.61414e+02, x2*(2.50460e-07) + (-7.53930e-05), -7.539302011695681e-05))))))))))",
  init_b_mfunc(3) = "if(x2 < 1.50211e+02, x2*(1.67756e-07) + (-1.58561e-05), if(x2 < 1.94381e+02, x2*(-2.74732e-06) + (4.22020e-04), if(x2 < 2.97438e+02, x2*(3.25152e-06) + (-7.44041e-04), if(x2 < 3.33512e+02, x2*(-2.28198e-05) + (7.01056e-03), if(x2 < 3.38401e+02, x2*(1.21021e-04) + (-4.09620e-02), if(x2 < 4.27793e+02, x2*(9.92748e-08) + (-4.19776e-05), if(x2 < 4.36306e+02, x2*(8.57903e-05) + (-3.67000e-02), if(x2 < 4.65122e+02, x2*(-2.0449e-05) + (9.65285e-03), if(x2 < 9.36838e+02, x2*(-4.27294e-07) + (3.4032e-04), if(x2 < 9.61414e+02, x2*(1.60943e-06) + (-1.56776e-03), -0.0015677639274298558))))))))))",
  type_init_e(1:3) = "math func", "math func", "math func",
  init_e_mfunc(1) = "if(x2 < 2.65639e+02, x2*(7.07807e-09) + (-2.84460e-07), if(x2 < 2.87565e+02, x2*(-8.21182e-07) + (2.19734e-04), if(x2 < 3.14087e+02, x2*(1.05396e-06) + (-3.19492e-04), if(x2 < 3.8835e+02, x2*(-2.53797e-07) + (9.1259e-05), if(x2 < 3.95809e+02, x2*(1.24860e-06) + (-4.92198e-04), if(x2 < 4.33167e+02, x2*(-1.32112e-07) + (5.43006e-05), if(x2 < 4.51295e+02, x2*(-3.29918e-07) + (1.39984e-04), if(x2 < 5.73294e+02, x2*(9.93185e-08) + (-5.37286e-05), if(x2 < 6.05094e+02, x2*(-1.06133e-07) + (6.40553e-05), if(x2 < 9.61414e+02, x2*(7.14092e-10) + (-5.96964e-07), -5.969643426709447e-07))))))))))",
  init_e_mfunc(2) = "if(x2 < 2.74976e+02, x2*(6.8108e-09) + (-6.09415e-07), if(x2 < 3.15748e+02, x2*(-1.93239e-07) + (5.43994e-05), if(x2 < 3.49657e+02, x2*(-3.20614e-06) + (1.00572e-03), if(x2 < 3.94082e+02, x2*(2.64155e-06) + (-1.03897e-03), if(x2 < 4.14858e+02, x2*(-2.817e-07) + (1.13030e-04), if(x2 < 4.46186e+02, x2*(8.69402e-07) + (-3.64513e-04), if(x2 < 4.63582e+02, x2*(-1.71109e-07) + (9.97486e-05), if(x2 < 4.64003e+02, x2*(5.98009e-05) + (-2.77022e-02), if(x2 < 5.12883e+02, x2*(-9.7721e-07) + (4.99025e-04), if(x2 < 9.61414e+02, x2*(4.84818e-09) + (-4.65604e-06), -4.656041003280651e-06))))))))))",
  init_e_mfunc(3) = "if(x2 < 1.14179e+02, x2*(-4.92453e-08) + (3.07317e-06), if(x2 < 2.70838e+02, x2*(2.05531e-07) + (-2.60169e-05), if(x2 < 2.91627e+02, x2*(-3.1097e-05) + (8.45188e-03), if(x2 < 3.35895e+02, x2*(5.71427e-05) + (-1.72812e-02), if(x2 < 4.69414e+02, x2*(-6.77409e-06) + (4.18816e-03), if(x2 < 4.82874e+02, x2*(-5.96823e-05) + (2.90240e-02), if(x2 < 4.98873e+02, x2*(-1.33894e-05) + (6.6704e-03), if(x2 < 6.61022e+02, x2*(6.83649e-08) + (-4.33331e-05), if(x2 < 8.4885e+02, x2*(-1.45839e-08) + (1.14979e-05), if(x2 < 9.61414e+02, x2*(1.29369e-08) + (-1.18631e-05), -1.1863056239403562e-05))))))))))", ! This is the most important component, can probably ignore others
}

!----------boundary conditions for em-fields ----------
emf_bound
{
 type(1:2,2) =  "open", "open", ! boundaries for x2
}

!----------- electro-magnetic field diagnostics ---------
diag_emf
{
 ndump_fac = 1,
 reports = 
   "b1", "b2", "b3",
   "e1", "e2", "e3",
}

!----------number of particle species----------
particles
{
  interpolation = "quadratic",
  num_species = 3,
}

!----------information for electrons----------
species
{
 name = "electrons",
 rqm=-1.0,
 num_par_x(1:2) = 7, 7, ! number of particles per cell in x and y directions
}

!----------inital proper velocities - electrons-----------------
udist
{
  use_spatial_uth = .true.,
  use_spatial_ufl = .true.,
  spatial_uth(1) = "if(x2 < 2.51231e+02, x2*(-1.74020e-06) + (5.80090e-02), if(x2 < 3.26053e+02, x2*(7.64403e-05) + (3.83677e-02), if(x2 < 3.36251e+02, x2*(1.62447e-03) + (-4.66372e-01), if(x2 < 3.76124e+02, x2*(1.44930e-04) + (3.1125e-02), if(x2 < 3.82571e+02, x2*(2.41908e-04) + (-5.35076e-03), if(x2 < 4.19687e+02, x2*(2.39215e-04) + (-4.32024e-03), if(x2 < 4.26601e+02, x2*(1.51233e-04) + (3.26043e-02), if(x2 < 4.75533e+02, x2*(4.72680e-05) + (7.6956e-02), if(x2 < 4.90989e+02, x2*(-3.51075e-03) + (1.76891e+00), if(x2 < 9.61414e+02, x2*(-3.39544e-06) + (4.68404e-02), 0.0468403797434113))))))))))",
  spatial_uth(2) = "if(x2 < 2.51231e+02, x2*(-1.74020e-06) + (5.80090e-02), if(x2 < 3.26053e+02, x2*(7.64403e-05) + (3.83677e-02), if(x2 < 3.36251e+02, x2*(1.62447e-03) + (-4.66372e-01), if(x2 < 3.76124e+02, x2*(1.44930e-04) + (3.1125e-02), if(x2 < 3.82571e+02, x2*(2.41908e-04) + (-5.35076e-03), if(x2 < 4.19687e+02, x2*(2.39215e-04) + (-4.32024e-03), if(x2 < 4.26601e+02, x2*(1.51233e-04) + (3.26043e-02), if(x2 < 4.75533e+02, x2*(4.72680e-05) + (7.6956e-02), if(x2 < 4.90989e+02, x2*(-3.51075e-03) + (1.76891e+00), if(x2 < 9.61414e+02, x2*(-3.39544e-06) + (4.68404e-02), 0.0468403797434113))))))))))",
  spatial_uth(3) = "if(x2 < 2.51231e+02, x2*(-1.74020e-06) + (5.80090e-02), if(x2 < 3.26053e+02, x2*(7.64403e-05) + (3.83677e-02), if(x2 < 3.36251e+02, x2*(1.62447e-03) + (-4.66372e-01), if(x2 < 3.76124e+02, x2*(1.44930e-04) + (3.1125e-02), if(x2 < 3.82571e+02, x2*(2.41908e-04) + (-5.35076e-03), if(x2 < 4.19687e+02, x2*(2.39215e-04) + (-4.32024e-03), if(x2 < 4.26601e+02, x2*(1.51233e-04) + (3.26043e-02), if(x2 < 4.75533e+02, x2*(4.72680e-05) + (7.6956e-02), if(x2 < 4.90989e+02, x2*(-3.51075e-03) + (1.76891e+00), if(x2 < 9.61414e+02, x2*(-3.39544e-06) + (4.68404e-02), 0.0468403797434113))))))))))",

  spatial_ufl(1) = "if(x2 < 4.88487e+01, x2*(-1.61219e-05) + (7.09438e-04), if(x2 < 1.15673e+02, x2*(8.16886e-08) + (-8.20851e-05), if(x2 < 2.34983e+02, x2*(4.29966e-06) + (-5.69989e-04), if(x2 < 2.72604e+02, x2*(1.19919e-05) + (-2.37753e-03), if(x2 < 3.06086e+02, x2*(-7.01292e-06) + (2.80325e-03), if(x2 < 3.94108e+02, x2*(2.36616e-06) + (-6.75504e-05), if(x2 < 5.54140e+02, x2*(-7.67807e-07) + (1.16757e-03), if(x2 < 5.87553e+02, x2*(4.67512e-06) + (-1.84857e-03), if(x2 < 8.22222e+02, x2*(1.90603e-07) + (7.86318e-04), if(x2 < 9.61414e+02, x2*(-2.76338e-07) + (1.17025e-03), 0.0011702475842441538))))))))))",
  spatial_ufl(2) = "if(x2 < 2.16027e+02, x2*(4.69387e-05) + (2.52470e-02), if(x2 < 2.78236e+02, x2*(3.43280e-06) + (3.46455e-02), if(x2 < 3.09349e+02, x2*(-8.25120e-05) + (5.85584e-02), if(x2 < 3.40361e+02, x2*(-1.33853e-04) + (7.44406e-02), if(x2 < 3.49986e+02, x2*(-3.35602e-04) + (1.43108e-01), if(x2 < 4.66826e+02, x2*(-1.79489e-05) + (3.19342e-02), if(x2 < 4.77648e+02, x2*(-3.52118e-05) + (3.99930e-02), if(x2 < 4.79292e+02, x2*(-4.24023e-03) + (2.04851e+00), if(x2 < 4.91072e+02, x2*(-1.38257e-03) + (6.78860e-01), if(x2 < 9.61414e+02, x2*(3.64066e-07) + (-2.60496e-04), -0.0002604959505210924))))))))))",
  spatial_ufl(3) = "if(x2 < 2.90119e+02, x2*(7.53226e-07) + (6.80536e-05), if(x2 < 3.18430e+02, x2*(-1.93107e-05) + (5.88898e-03), if(x2 < 3.42603e+02, x2*(6.52931e-05) + (-2.10514e-02), if(x2 < 4.22274e+02, x2*(-1.67053e-05) + (7.04145e-03), if(x2 < 4.32494e+02, x2*(-4.88124e-05) + (2.05994e-02), if(x2 < 4.79898e+02, x2*(7.69907e-06) + (-3.84142e-03), if(x2 < 4.84223e+02, x2*(2.83496e-04) + (-1.36196e-01), if(x2 < 5.26531e+02, x2*(-2.64172e-05) + (1.38714e-02), if(x2 < 6.24290e+02, x2*(8.57977e-07) + (-4.89822e-04), if(x2 < 9.61414e+02, x2*(-3.3964e-08) + (6.70081e-05), 6.700809882530195e-05))))))))))",
}

!----------density profile for electrons----------
profile
{
  profile_type(1:2) = "uniform", "piecewise-linear",
  num_x = 57,
  x(1:57,2) = 0., 16.58, 33.15, 49.73, 66.30, 82.88, 99.46, 116.03, 132.61, 149.18, 165.76, 182.34, 198.91, 215.49, 232.07, 248.64, 265.22, 281.79, 298.37, 314.95, 331.52, 348.1, 364.67, 381.25, 397.83, 414.40, 430.98, 447.55, 464.13, 480.71, 497.28, 513.86, 530.44, 547.01, 563.59, 580.16, 596.74, 613.32, 629.89, 646.47, 663.04, 679.62, 696.2, 712.77, 729.35, 745.92, 762.50, 779.08, 795.65, 812.23, 828.81, 845.38, 861.96, 878.53, 895.11, 911.69, 928.26,
  fx(1:57,2) = 54.49, 47.27, 42.15, 38.53, 35.93, 34.05, 32.17, 30.13, 28.04, 26.08, 24.19, 22.51, 21., 19.6, 18.60, 17.52, 16.47, 15.51, 14.24, 14.09, 7.68, 4.09, 4.01, 4.03, 3.92, 3.87, 3.89, 3.88, 3.92, 3.09, 1.40, 1.39, 1.4, 1.40, 1.40, 1.38, 1.37, 1.36, 1.36, 1.38, 1.39, 1.42, 1.44, 1.47, 1.48, 1.51, 1.53, 1.54, 1.55, 1.57, 1.59, 1.59, 1.59, 1.59, 1.58, 1.55, 1.53,
}

!----------boundary conditions for electrons----------
spe_bound
{
 type(1:2,2) = "thermal","thermal",
 uth_bnd(1:3,1,2) = 0.05821496391274283,0.05821496391274283,0.05821496391274283,
 uth_bnd(1:3,2,2) = 0.05816689794170529,0.05816689794170529,0.05816689794170529,
}

!----------diagnostic for electrons----------
diag_species
{
 ndump_fac = 1,
 reports = "charge",
 ndump_fac_pha = 1,
 ps_pmin(1:3) = -0.15, -0.15, -0.15,
 ps_pmax(1:3) = 0.15, 0.15, 0.15,
 ps_xmin(1:2) = -7, 0, ! phase space covers the entire domain. change as needed
 ps_xmax(1:2) = 7, 961,
 ps_np(1:3) = 128, 1024, 128,
 ps_nx(1:2) = 256, 1024,
 phasespaces = "p1x1", "p1x2", "p2x1", "p2x2",
}
   
!----------information for Aluminum ions----------
species
{
 name = "aluminum",
 rqm = 38,
 num_par_x(1:2) = 7, 7, ! number of particles per cell in x and y directions
}

!----------inital proper velocities Aluminum ions-----------------
udist
{
  use_spatial_uth = .true.,
  use_spatial_ufl = .true.,
  spatial_uth(1) = "if(x2 < 3.82325e+01, x2*(-1.14885e-05) + (6.87670e-03), if(x2 < 2.64973e+02, x2*(-5.19148e-06) + (6.63595e-03), if(x2 < 3.27513e+02, x2*(7.55532e-07) + (5.06016e-03), if(x2 < 3.31484e+02, x2*(2.37234e-04) + (-7.23896e-02), if(x2 < 3.58608e+02, x2*(-6.17872e-05) + (2.67310e-02), if(x2 < 4.34005e+02, x2*(8.35805e-06) + (1.57639e-03), if(x2 < 4.76463e+02, x2*(1.20301e-06) + (4.68172e-03), if(x2 < 4.86556e+02, x2*(-2.66433e-04) + (1.32200e-01), if(x2 < 7.01708e+02, x2*(1.61628e-08) + (2.55800e-03), if(x2 < 9.61414e+02, x2*(3.30755e-07) + (2.33725e-03), 0.0023372500677600184))))))))))",
  spatial_uth(2) = "if(x2 < 3.82325e+01, x2*(-1.14885e-05) + (6.87670e-03), if(x2 < 2.64973e+02, x2*(-5.19148e-06) + (6.63595e-03), if(x2 < 3.27513e+02, x2*(7.55532e-07) + (5.06016e-03), if(x2 < 3.31484e+02, x2*(2.37234e-04) + (-7.23896e-02), if(x2 < 3.58608e+02, x2*(-6.17872e-05) + (2.67310e-02), if(x2 < 4.34005e+02, x2*(8.35805e-06) + (1.57639e-03), if(x2 < 4.76463e+02, x2*(1.20301e-06) + (4.68172e-03), if(x2 < 4.86556e+02, x2*(-2.66433e-04) + (1.32200e-01), if(x2 < 7.01708e+02, x2*(1.61628e-08) + (2.55800e-03), if(x2 < 9.61414e+02, x2*(3.30755e-07) + (2.33725e-03), 0.0023372500677600184))))))))))",
  spatial_uth(3) = "if(x2 < 3.82325e+01, x2*(-1.14885e-05) + (6.87670e-03), if(x2 < 2.64973e+02, x2*(-5.19148e-06) + (6.63595e-03), if(x2 < 3.27513e+02, x2*(7.55532e-07) + (5.06016e-03), if(x2 < 3.31484e+02, x2*(2.37234e-04) + (-7.23896e-02), if(x2 < 3.58608e+02, x2*(-6.17872e-05) + (2.67310e-02), if(x2 < 4.34005e+02, x2*(8.35805e-06) + (1.57639e-03), if(x2 < 4.76463e+02, x2*(1.20301e-06) + (4.68172e-03), if(x2 < 4.86556e+02, x2*(-2.66433e-04) + (1.32200e-01), if(x2 < 7.01708e+02, x2*(1.61628e-08) + (2.55800e-03), if(x2 < 9.61414e+02, x2*(3.30755e-07) + (2.33725e-03), 0.0023372500677600184))))))))))",

  spatial_ufl(1) = "if(x2 < 3.01698e+01, x2*(-2.12310e-05) + (7.64892e-04), if(x2 < 4.22090e+01, x2*(-5.59053e-06) + (2.93021e-04), if(x2 < 5.70422e+01, x2*(-1.41201e-05) + (6.53047e-04), if(x2 < 1.98313e+02, x2*(2.76544e-06) + (-3.10143e-04), if(x2 < 3.02086e+02, x2*(6.56479e-06) + (-1.06360e-03), if(x2 < 3.32887e+02, x2*(-1.18001e-05) + (4.48416e-03), if(x2 < 4.13162e+02, x2*(5.01290e-06) + (-1.11266e-03), if(x2 < 4.34324e+02, x2*(-1.02749e-05) + (5.20368e-03), if(x2 < 8.81049e+02, x2*(5.51135e-07) + (5.01672e-04), if(x2 < 9.61414e+02, x2*(-1.34276e-06) + (2.17029e-03), 0.0021702859241882113))))))))))",
  spatial_ufl(2) = "if(x2 < 1.32891e+02, x2*(5.32705e-05) + (2.48953e-02), if(x2 < 2.45875e+02, x2*(3.39209e-05) + (2.74667e-02), if(x2 < 2.9047e+02, x2*(-1.28373e-05) + (3.89634e-02), if(x2 < 3.77764e+02, x2*(-1.31224e-04) + (7.33511e-02), if(x2 < 3.96975e+02, x2*(5.55351e-05) + (2.80028e-03), if(x2 < 4.73129e+02, x2*(-1.70851e-05) + (3.16287e-02), if(x2 < 4.89553e+02, x2*(-1.42223e-03) + (6.96442e-01), if(x2 < 5.90329e+02, x2*(-2.47631e-06) + (1.39847e-03), if(x2 < 6.65442e+02, x2*(5.66504e-07) + (-3.97788e-04), if(x2 < 9.61414e+02, x2*(1.36349e-07) + (-1.11545e-04), -0.00011154463200588662))))))))))",
  spatial_ufl(3) = "if(x2 < 3.89231e+01, x2*(2.29802e-06) + (4.82962e-05), if(x2 < 4.9334e+01, x2*(9.61593e-06) + (-2.3654e-04), if(x2 < 1.96051e+02, x2*(-1.36498e-06) + (3.05192e-04), if(x2 < 3.047e+02, x2*(4.17272e-06) + (-7.80477e-04), if(x2 < 3.49859e+02, x2*(1.76535e-05) + (-4.88807e-03), if(x2 < 4.79942e+02, x2*(-1.86287e-05) + (7.8056e-03), if(x2 < 5.02743e+02, x2*(6.38278e-05) + (-3.17687e-02), if(x2 < 5.26082e+02, x2*(-1.18559e-05) + (6.28074e-03), if(x2 < 7.62376e+02, x2*(3.64992e-09) + (4.16491e-05), if(x2 < 9.61414e+02, x2*(1.98638e-08) + (2.9288e-05), 2.9287964199627352e-05))))))))))",
}

!----------density profile for Aluminum ions----------
profile
{
  profile_type(1:2) = "uniform", "piecewise-linear",
  num_x = 57,
  x(1:57,2) = 0., 16.58, 33.15, 49.73, 66.30, 82.88, 99.46, 116.03, 132.61, 149.18, 165.76, 182.34, 198.91, 215.49, 232.07, 248.64, 265.22, 281.79, 298.37, 314.95, 331.52, 348.1, 364.67, 381.25, 397.83, 414.40, 430.98, 447.55, 464.13, 480.71, 497.28, 513.86, 530.44, 547.01, 563.59, 580.16, 596.74, 613.32, 629.89, 646.47, 663.04, 679.62, 696.2, 712.77, 729.35, 745.92, 762.50, 779.08, 795.65, 812.23, 828.81, 845.38, 861.96, 878.53, 895.11, 911.69, 928.26,
  fx(1:57,2) = 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 7.68, 4.09, 4.01, 4.03, 3.92, 3.87, 3.89, 3.88, 3.92, 3.09, 1.40, 1.39, 1.4, 1.40, 1.40, 1.38, 1.37, 1.36, 1.36, 1.38, 1.39, 1.42, 1.44, 1.47, 1.48, 1.51, 1.53, 1.54, 1.55, 1.57, 1.59, 1.59, 1.59, 1.59, 1.58, 1.55, 1.53,
}

!----------boundary conditions for Alumium ions----------
spe_bound
{
 type(1:2,2) = "thermal", "thermal",
 uth_bnd(1:3,1,2) = 0.006929304075270467,0.006929304075270467,0.006929304075270467,
 uth_bnd(1:3,2,2) = 0.00679802522524855,0.00679802522524855,0.00679802522524855,
}

!----------diagnostic for Aluminum ions----------
diag_species
{
 ndump_fac = 1,
 reports = "charge",
 ndump_fac_pha = 1,
 ps_pmin(1:3) = -0.15, -0.15, -0.15, 
 ps_pmax(1:3) = 0.15, 0.15, 0.15,
 ps_xmin(1:2) = -7, 0,
 ps_xmax(1:2) = 7, 961,
 ps_np(1:3) = 128, 1024, 128,
 ps_nx(1:2) = 256, 1024,
 phasespaces = "p1x1", "p1x2", "p2x1", "p2x2",
}

!----------information for Silicon ions----------
species
{
 name = "silicon",
 rqm = 36,
 num_par_x(1:2) = 7, 7, ! number of particles per cell in x and y directions
}

!----------inital proper velocities Silicon ions-----------------
udist
{
  use_spatial_uth = .true.,
  use_spatial_ufl = .true.,
  spatial_uth(1) = "if(x2 < 3.82325e+01, x2*(-1.14885e-05) + (6.87670e-03), if(x2 < 2.64973e+02, x2*(-5.19148e-06) + (6.63595e-03), if(x2 < 3.27513e+02, x2*(7.55532e-07) + (5.06016e-03), if(x2 < 3.31484e+02, x2*(2.37234e-04) + (-7.23896e-02), if(x2 < 3.58608e+02, x2*(-6.17872e-05) + (2.67310e-02), if(x2 < 4.34005e+02, x2*(8.35805e-06) + (1.57639e-03), if(x2 < 4.76463e+02, x2*(1.20301e-06) + (4.68172e-03), if(x2 < 4.86556e+02, x2*(-2.66433e-04) + (1.32200e-01), if(x2 < 7.01708e+02, x2*(1.61628e-08) + (2.55800e-03), if(x2 < 9.61414e+02, x2*(3.30755e-07) + (2.33725e-03), 0.0023372500677600184))))))))))",
  spatial_uth(2) = "if(x2 < 3.82325e+01, x2*(-1.14885e-05) + (6.87670e-03), if(x2 < 2.64973e+02, x2*(-5.19148e-06) + (6.63595e-03), if(x2 < 3.27513e+02, x2*(7.55532e-07) + (5.06016e-03), if(x2 < 3.31484e+02, x2*(2.37234e-04) + (-7.23896e-02), if(x2 < 3.58608e+02, x2*(-6.17872e-05) + (2.67310e-02), if(x2 < 4.34005e+02, x2*(8.35805e-06) + (1.57639e-03), if(x2 < 4.76463e+02, x2*(1.20301e-06) + (4.68172e-03), if(x2 < 4.86556e+02, x2*(-2.66433e-04) + (1.32200e-01), if(x2 < 7.01708e+02, x2*(1.61628e-08) + (2.55800e-03), if(x2 < 9.61414e+02, x2*(3.30755e-07) + (2.33725e-03), 0.0023372500677600184))))))))))",
  spatial_uth(3) = "if(x2 < 3.82325e+01, x2*(-1.14885e-05) + (6.87670e-03), if(x2 < 2.64973e+02, x2*(-5.19148e-06) + (6.63595e-03), if(x2 < 3.27513e+02, x2*(7.55532e-07) + (5.06016e-03), if(x2 < 3.31484e+02, x2*(2.37234e-04) + (-7.23896e-02), if(x2 < 3.58608e+02, x2*(-6.17872e-05) + (2.67310e-02), if(x2 < 4.34005e+02, x2*(8.35805e-06) + (1.57639e-03), if(x2 < 4.76463e+02, x2*(1.20301e-06) + (4.68172e-03), if(x2 < 4.86556e+02, x2*(-2.66433e-04) + (1.32200e-01), if(x2 < 7.01708e+02, x2*(1.61628e-08) + (2.55800e-03), if(x2 < 9.61414e+02, x2*(3.30755e-07) + (2.33725e-03), 0.0023372500677600184))))))))))",

  spatial_ufl(1) = "if(x2 < 3.01698e+01, x2*(-2.12310e-05) + (7.64892e-04), if(x2 < 4.22090e+01, x2*(-5.59053e-06) + (2.93021e-04), if(x2 < 5.70422e+01, x2*(-1.41201e-05) + (6.53047e-04), if(x2 < 1.98313e+02, x2*(2.76544e-06) + (-3.10143e-04), if(x2 < 3.02086e+02, x2*(6.56479e-06) + (-1.06360e-03), if(x2 < 3.32887e+02, x2*(-1.18001e-05) + (4.48416e-03), if(x2 < 4.13162e+02, x2*(5.01290e-06) + (-1.11266e-03), if(x2 < 4.34324e+02, x2*(-1.02749e-05) + (5.20368e-03), if(x2 < 8.81049e+02, x2*(5.51135e-07) + (5.01672e-04), if(x2 < 9.61414e+02, x2*(-1.34276e-06) + (2.17029e-03), 0.0021702859241882113))))))))))",
  spatial_ufl(2) = "if(x2 < 1.32891e+02, x2*(5.32705e-05) + (2.48953e-02), if(x2 < 2.45875e+02, x2*(3.39209e-05) + (2.74667e-02), if(x2 < 2.9047e+02, x2*(-1.28373e-05) + (3.89634e-02), if(x2 < 3.77764e+02, x2*(-1.31224e-04) + (7.33511e-02), if(x2 < 3.96975e+02, x2*(5.55351e-05) + (2.80028e-03), if(x2 < 4.73129e+02, x2*(-1.70851e-05) + (3.16287e-02), if(x2 < 4.89553e+02, x2*(-1.42223e-03) + (6.96442e-01), if(x2 < 5.90329e+02, x2*(-2.47631e-06) + (1.39847e-03), if(x2 < 6.65442e+02, x2*(5.66504e-07) + (-3.97788e-04), if(x2 < 9.61414e+02, x2*(1.36349e-07) + (-1.11545e-04), -0.00011154463200588662))))))))))",
  spatial_ufl(3) = "if(x2 < 3.89231e+01, x2*(2.29802e-06) + (4.82962e-05), if(x2 < 4.9334e+01, x2*(9.61593e-06) + (-2.3654e-04), if(x2 < 1.96051e+02, x2*(-1.36498e-06) + (3.05192e-04), if(x2 < 3.047e+02, x2*(4.17272e-06) + (-7.80477e-04), if(x2 < 3.49859e+02, x2*(1.76535e-05) + (-4.88807e-03), if(x2 < 4.79942e+02, x2*(-1.86287e-05) + (7.8056e-03), if(x2 < 5.02743e+02, x2*(6.38278e-05) + (-3.17687e-02), if(x2 < 5.26082e+02, x2*(-1.18559e-05) + (6.28074e-03), if(x2 < 7.62376e+02, x2*(3.64992e-09) + (4.16491e-05), if(x2 < 9.61414e+02, x2*(1.98638e-08) + (2.9288e-05), 2.9287964199627352e-05))))))))))",
}

!----------density profile for Silicon ions----------
profile
{
  profile_type(1:2) = "uniform", "piecewise-linear",
  num_x = 57,
  x(1:57,2) = 0., 16.58, 33.15, 49.73, 66.30, 82.88, 99.46, 116.03, 132.61, 149.18, 165.76, 182.34, 198.91, 215.49, 232.07, 248.64, 265.22, 281.79, 298.37, 314.95, 331.52, 348.1, 364.67, 381.25, 397.83, 414.40, 430.98, 447.55, 464.13, 480.71, 497.28, 513.86, 530.44, 547.01, 563.59, 580.16, 596.74, 613.32, 629.89, 646.47, 663.04, 679.62, 696.2, 712.77, 729.35, 745.92, 762.50, 779.08, 795.65, 812.23, 828.81, 845.38, 861.96, 878.53, 895.11, 911.69, 928.26,
  fx(1:57,2) = 54.49, 47.27, 42.15, 38.53, 35.93, 34.05, 32.17, 30.13, 28.04, 26.08, 24.19, 22.51, 21., 19.6, 18.60, 17.52, 16.47, 15.51, 14.24, 14.09, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
}

!----------boundary conditions for Silicon ions----------
spe_bound
{
 type(1:2,2) = "thermal","thermal",
 uth_bnd(1:3,1,2) = 0.006929304075270467,0.006929304075270467,0.006929304075270467,
 uth_bnd(1:3,2,2) = 0.00679802522524855,0.00679802522524855,0.00679802522524855,
}

!----------diagnostic for Silicon ions----------
diag_species
{
 ndump_fac = 1,
 reports = "charge",
 ndump_fac_pha = 1,
 ps_pmin(1:3) = -0.15, -0.15, -0.15, 
 ps_pmax(1:3) = 0.15, 0.15, 0.15,
 ps_xmin(1:2) = -7, 0,
 ps_xmax(1:2) = 7, 961,
 ps_np(1:3) = 128, 1024, 128,
 ps_nx(1:2) = 256, 1024,
 phasespaces = "p1x1", "p1x2", "p2x1", "p2x2",
}

!--------Current smoothing----------
smooth
{
  type = "compensated",
  order = 2,
}
